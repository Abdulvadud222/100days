###we spent the whole day debugging!